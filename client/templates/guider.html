<!--

   Copyright(c) 2022 Max Qian  <astroair.cn>

   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.
   
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
   
   You should have received a copy of the GNU General Public License
   along with this program; if not, write to the Free Software
   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
   MA 02110-1301, USA.
   
-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Guider</title>

    <link rel='Shortcut Icon' type='image/x-icon' href='/static/textures/icons/guider.png'>

    <!-- Font Awesome 6.2.0 Pro -->
    <link rel="stylesheet" href="/static/css/fontawesome.min.css">
    <link rel="stylesheet" href="/static/css/solid.min.css">
    <!-- Select2 -->
    <link rel="stylesheet" href="/static/css/select2.min.css">
    <!-- Icheck -->
    <link rel="stylesheet" href="/static/css/icheck-bootstrap.min.css">
    <!-- Select2 with bootstrap -->
    <link rel="stylesheet" href="/static/css/select2-bootstrap4.min.css">
    <!-- BS Stepper -->
    <link rel="stylesheet" href="/static/css/bs-stepper.min.css">
    <!-- bootstrap slider -->
    <link rel="stylesheet" href="/static/css/bootstrap-slider.min.css">
    <!-- AdminLTE Theme style -->
    <link rel="stylesheet" href="/static/css/adminlte.min.css">
    <!-- Loading animation -->
    <link rel="stylesheet" href="/static/css/loading.css">

    <style>
        .guiding-pictures {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .guiding-pictures>li {
            border: 1px solid transparent;
            float: left;
            height: calc(100% / 3);
            margin: 0 -1px -1px 0;
            overflow: hidden;
            width: calc(100% / 3);
        }

        .guiding-pictures>li>img {
            cursor: -webkit-zoom-in;
            cursor: zoom-in;
            width: 100%;
        }
    </style>
</head>

<body style="height: auto;" class="dark-mode">
    <!-- loading开始 -->
    <div id="loading-animation">
        <div id="loading-animation-center">
            <div id="loading-animation-center-absolute">
                <div class="loading_object" id="loading_four"></div>
                <div class="loading_object" id="loading_three"></div>
                <div class="loading_object" id="loading_two"></div>
                <div class="loading_object" id="loading_one"></div>
            </div>
        </div>
    </div>
    <script>!function () { function e() { setTimeout(() => { $("#loading-animation").fadeOut(540) }, 500) } window.jQuery ? $(document).ready(() => { e() }) : document.onreadystatechange = (() => { "interactive" === document.readyState && e() }) }();</script>
    <!-- loading 结束 -->
    <div class="wrapper">
        <!-- Main content -->
        <section class="content" data-widget="iframe">
            <div class="container-fluid">
                <div class="row">
                    <div class="col px-lg-1 px-xl-2 mb-xl-4 mb-2">
                        <div class="card elegant-color h100 card-default card-primary">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-star mr-2"></i>
                                    导星
                                </div>
                            </div>
                            <!-- Card content -->
                            <div class="card-body">
                                <div class="row">
                                    <div class="col px-lg-1 px-xl-2 mb-xl-4 mb-2">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="card elegant-color h100 card-default card-primary">
                                                            <div class="card-header">
                                                                <div class="card-title">
                                                                    <i class="fas fa-file-image mr-2"></i>
                                                                    导星图像
                                                                </div>
                                                                <div class="card-tools">
                                                                    <button type="button" class="btn btn-tool"
                                                                                id="refresh_guiding_image">
                                                                                <i class="fas fa-redo"></i>
                                                                            </button>
                                                                    <button type="button" class="btn btn-tool"
                                                                        data-card-widget="collapse" title="Collapse">
                                                                        <i class="fas fa-minus"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <!-- Card content -->
                                                            <div class="card-body">
                                                                <img id="guiding_image" src="/static/textures/background.png" class="img-fit-contain img-thumbnail">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="card elegant-color h100 card-default card-primary">
                                                            <div class="card-header">
                                                                <div class="card-title">
                                                                    <i class="fas fa-blog mr-2"></i>
                                                                    导星日志
                                                                </div>
                                                                <div class="card-tools">
                                                                    <button type="button" class="btn btn-tool"
                                                                                id="refresh_guiding_image">
                                                                                <i class="fas fa-redo"></i>
                                                                            </button>
                                                                    <button type="button" class="btn btn-tool"
                                                                        data-card-widget="collapse" title="Collapse">
                                                                        <i class="fas fa-minus"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <!-- Card content -->
                                                            <div class="card-body">
                                                                <textarea id="output-json" rows="5"
                                                                style="width: 100%; font-family: monospace;"
                                                                class="form-control"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="card elegant-color h100 card-default card-primary collapsed-card">
                                                            <div class="card-header">
                                                                <div class="card-title">
                                                                    <i class="fas fa-chart-user mr-2"></i>
                                                                    导星曲线
                                                                </div>
                                                                <div class="card-tools">
                                                                    <button type="button" class="btn btn-tool"
                                                                        id="refresh_guiding_line">
                                                                        <i class="fas fa-redo"></i>
                                                                    </button>
                                                                    <button type="button" class="btn btn-tool"
                                                                        data-card-widget="collapse" title="Collapse">
                                                                        <i class="fas fa-minus"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <div class="card-body">
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="chart">
                                                                            <canvas id="guiding_line" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="row">
                                                                            <div class="col-md-3">
                                                                                <div class="form-group form-group-sm">
                                                                                    <label>X轴</label>
                                                                                    <select class="form-control select2 form-control-sm"
                                                                                        id="x_axis" style="width: 100%;">
                                                                                        <option value="50">50</option>
                                                                                        <option value="100" selected="selected">100</option>
                                                                                        <option value="150">150</option>
                                                                                        <option value="200">200</option>
                                                                                    </select>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="form-group form-group-sm">
                                                                                    <label>Y轴</label>
                                                                                    <select class="form-control select2 form-control-sm"
                                                                                        id="y_axis" style="width: 100%;">
                                                                                        <option value="1">1</option>
                                                                                        <option value="2">2</option>
                                                                                        <option value="4" selected="selected">4</option>
                                                                                        <option value="8">8</option>
                                                                                        <option value="16">16</option>
                                                                                    </select>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-6">
                                                                                <div class="row">
                                                                                    <div class="col-md-6">
                                                                                        <button id="guiding_line_refresh" type="button" class="btn btn-block btn-info btn-sm">
                                                                                            <i class="fas fa-redo"></i>
                                                                                            刷新
                                                                                        </button>
                                                                                    </div>
                                                                                    <div class="col-md-6">
                                                                                        <button id="guiding_line_clear" type="button" class="btn btn-block btn-info btn-sm">
                                                                                            <i class="fas fa-brush"></i>
                                                                                            清除
                                                                                        </button>
                                                                                    </div>
                                                                                </div>
                                                                                
                                                                                <div class="row pl-2 pt-2">
                                                                                    <div class="col-md-6">
                                                                                        <label>修正线</label>
                                                                                        <div class="icheck-success d-inline">
                                                                                            <input class="input-sm" type="checkbox" checked
                                                                                                id="correction_line">
                                                                                            <label for="correction_line"></label>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="col-md-6">
                                                                                        <label>趋势线</label>
                                                                                        <div class="icheck-success d-inline">
                                                                                            <input class="input-sm" type="checkbox" checked
                                                                                                id="trend_line">
                                                                                            <label for="trend_line"></label>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="card elegant-color h100 card-default card-primary collapsed-card">
                                                            <div class="card-header">
                                                                <div class="card-title">
                                                                    <i class="fas fa-radar mr-2"></i>
                                                                    散点图
                                                                </div>
                                                                <div class="card-tools">
                                                                    <button type="button" class="btn btn-tool"
                                                                        id="refresh_scatter_plot">
                                                                        <i class="fas fa-redo"></i>
                                                                    </button>
                                                                    <button type="button" class="btn btn-tool"
                                                                        data-card-widget="collapse" title="Collapse">
                                                                        <i class="fas fa-minus"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <div class="card-body">
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="row">
                                                                            <div class="col-md-6">
                                                                                <canvas id="scatter_plot" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                                                                            </div>
                                                                            <div class="col-md-6">
                                                                                <div class="row">
                                                                                    <div class="col-md-12">
                                                                                        <div class="row">
                                                                                            <div class="col-md-6">
                                                                                                <div class="form-group form-group-sm">
                                                                                                    <label>历史帧</label>
                                                                                                    <select class="form-control select2 form-control-sm"
                                                                                                        id="history_frame">
                                                                                                        <option value="50">50</option>
                                                                                                        <option value="100" selected="selected">100</option>
                                                                                                        <option value="150">150</option>
                                                                                                        <option value="200">200</option>
                                                                                                    </select>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="col-md-6">
                                                                                                <div class="form-group form-group-sm">
                                                                                                    <label>散点图半径</label>
                                                                                                    <input type="text" class="form-control form-control-sm"
                                                                                                        id="scatter_plot_radius" placeholder="请输入半径">
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="row">
                                                                                        <div class="col-md-6">
                                                                                            <button id="scatter_plot_refresh" type="button" class="btn btn-block btn-info btn-sm">
                                                                                                <i class="fas fa-redo"></i>
                                                                                                刷新
                                                                                            </button>
                                                                                        </div>
                                                                                        <div class="col-md-6">
                                                                                            <button id="scatter_plot_clear" type="button" class="btn btn-block btn-info btn-sm">
                                                                                                <i class="fas fa-brush"></i>
                                                                                                清除
                                                                                            </button>
                                                                                        </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="card elegant-color h100 card-default card-primary">
                                                            <div class="card-header">
                                                                <div class="card-title">
                                                                    <i class="fas fa-gears mr-2"></i>
                                                                    导星设置
                                                                </div>
                                                                <div class="card-tools">
                                                                    <button type="button" class="btn btn-tool"
                                                                        data-card-widget="collapse" title="Collapse">
                                                                        <i class="fas fa-minus"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <div class="card-body">
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="card elegant-color h100 card-default card-primary collapsed-card">
                                                                            <div class="card-header">
                                                                                <div class="card-title">
                                                                                    <i class="fas fa-telescope mr-2"></i>
                                                                                    设备连接
                                                                                </div>
                                                                                <div class="card-tools">
                                                                                    <button type="button" class="btn btn-tool"
                                                                                        data-card-widget="collapse" title="Collapse">
                                                                                        <i class="fas fa-minus"></i>
                                                                                    </button>
                                                                                </div>
                                                                            </div>
                                                                            <div class="card-body">
                                                                                <div class="row">
                                                                                    <div class="col-md-12">
                                                                                        <div class="bs-stepper">
                                                                                            <div class="bs-stepper-header" role="tablist">
                                                                                                <!-- your steps here -->
                                                                                                <div class="step" data-target="#connect-server-part">
                                                                                                    <button type="button" class="step-trigger" role="tab" aria-controls="connect-server-part" id="connect-server-part-trigger">
                                                                                                        <span class="bs-stepper-circle">1</span>
                                                                                                        <span class="bs-stepper-label">连接服务器</span>
                                                                                                    </button>
                                                                                                </div>
                                                                                                <div class="line"></div>
                                                                                                <div class="step" data-target="#connect-device-part">
                                                                                                    <button type="button" class="step-trigger" role="tab" aria-controls="connect-device-part" id="connect-device-part-trigger">
                                                                                                        <span class="bs-stepper-circle">2</span>
                                                                                                        <span class="bs-stepper-label">连接设备</span>
                                                                                                    </button>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="bs-stepper-content">
                                                                                                <div id="connect-server-part" class="content" role="tabpanel" aria-labelledby="connect-server-part-trigger">
                                                                                                    <div class="row">
                                                                                                        <div class="col-md-5">
                                                                                                            <div class="form-group form-group-sm">
                                                                                                                <label for="server_host">服务器主机</label>
                                                                                                                <input type="text" autocomplete="off" class=" text-bg-dark form-control form-control-sm" id="server_host" placeholder="127.0.0.1">
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div class="col-md-5">
                                                                                                            <div class="form-group form-group-sm">
                                                                                                                <label for="server_port">服务器端口</label>
                                                                                                                <input type="number" autocomplete="off" class="form-control form-control-sm" id="server_port" placeholder="5000">
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div class="col-md-2">
                                                                                                            <button id="server_connect" class="btn btn-outline-info">
                                                                                                                <i class="fas fa-link"></i><br>
                                                                                                                连接
                                                                                                            </button>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div id="connect-device-part" class="content" role="tabpanel" aria-labelledby="information-part-trigger">
                                                                                                    <div class="row">
                                                                                                        <div class="col-md-5">
                                                                                                            <div class="form-group form-group-sm">
                                                                                                                <label for="phd2_host">PHD2主机</label>
                                                                                                                <input type="text" autocomplete="off" class="form-control form-control-sm" id="phd2_host" placeholder="127.0.0.1">
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div class="col-md-5">
                                                                                                            <div class="form-group form-group-sm">
                                                                                                                <label for="phd2_port">PHD2端口</label>
                                                                                                                <input type="number" autocomplete="off" class="form-control form-control-sm" id="phd2_port" placeholder="5000">
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div class="col-md-2">
                                                                                                            <button id="phd2_connect" class="btn btn-outline-info">
                                                                                                                <i class="fas fa-link"></i><br>
                                                                                                                连接
                                                                                                            </button>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="card card-default card-primary collapsed-card">
                                                                            <div class="card-header">
                                                                                <div class="card-title">
                                                                                    <i class="fas fa-joystick mr-2"></i>
                                                                                    导星
                                                                                </div>
                                                                                <div class="card-tools">
                                                                                    <button type="button" class="btn btn-tool"
                                                                                        data-card-widget="collapse" title="Collapse">
                                                                                        <i class="fas fa-minus"></i>
                                                                                    </button>
                                                                                </div>
                                                                            </div>
                                                                            <div class="card-body">
                                                                                <div class="row">
                                                                                    <div class="col-md-12">
                                                                                        <div class="row">
                                                                                            <div class="col-md-12">
                                                                                                <div class="form-group form-group-sm">
                                                                                                    <div class="row">
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="start_exposure" class="btn btn-info btn-block btn-sm">
                                                                                                                <i class="fas fa-circle-arrow-left"></i>
                                                                                                                开始循环
                                                                                                            </button>
                                                                                                        </div>
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="abort_exposure" class="btn btn-danger btn-block btn-sm">
                                                                                                                <i class="fas fa-circle-arrow-right"></i>
                                                                                                                停止循环
                                                                                                            </button>
                                                                                                        </div>
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="auto_select" class="btn btn-outline-info btn-block btn-sm">
                                                                                                                <i class="fas fa-sensor"></i>
                                                                                                                自动选星
                                                                                                            </button>
                                                                                                        </div>
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="cancel_select" class="btn btn-outline-danger btn-block btn-sm">
                                                                                                                <i class="fas fa-cancel"></i>
                                                                                                                取消选择
                                                                                                            </button>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="row">
                                                                                            <div class="col-md-12">
                                                                                                <div class="form-group form-group-sm">
                                                                                                    <div class="row">
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="start_guiding" class="btn btn-info btn-block btn-sm">
                                                                                                                <i class="fas fa-goal-net"></i>
                                                                                                                开始导星
                                                                                                            </button>
                                                                                                        </div>
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="abort_guiding" class="btn btn-danger btn-block btn-sm">
                                                                                                                <i class="fas fa-cancel"></i>
                                                                                                                停止导星
                                                                                                            </button>
                                                                                                        </div>
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="start_calibration" class="btn btn-outline-info btn-block btn-sm">
                                                                                                                <i class="fas fa-camera-viewfinder"></i>
                                                                                                                开始校准
                                                                                                            </button>
                                                                                                        </div>
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="abort_calibration" class="btn btn-outline-danger btn-block btn-sm">
                                                                                                                <i class="fas fa-cancel"></i>
                                                                                                                停止校准
                                                                                                            </button>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            
                                                                                        </div>
                                                                                        <div class="row">
                                                                                            <div class="col-md-12">
                                                                                                <div class="form-group form-group-sm">
                                                                                                    <div class="row">
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="start_dither" class="btn btn-info btn-block btn-sm">
                                                                                                                <i class="fas fa-goal-net"></i>
                                                                                                                开始抖动
                                                                                                            </button>
                                                                                                        </div>
                                                                                                        <div class="col-md-3">
                                                                                                            <button id="abort_dither" class="btn btn-danger btn-block btn-sm">
                                                                                                                <i class="fas fa-cancel"></i>
                                                                                                                停止抖动
                                                                                                            </button>
                                                                                                        </div>
                                                                                                        <div class="col-md-3">

                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="card card-default card-primary collapsed-card">
                                                                            <div class="card-header">
                                                                                <div class="card-title">
                                                                                    <i class="fas fa-gears mr-2"></i>
                                                                                    导星设置
                                                                                </div>
                                                                                <div class="card-tools">
                                                                                    <button type="button" class="btn btn-tool"
                                                                                        data-card-widget="collapse" title="Collapse">
                                                                                        <i class="fas fa-minus"></i>
                                                                                    </button>
                                                                                </div>
                                                                            </div>
                                                                            <div class="card-body">
                                                                                <div class="row">
                                                                                    <div class="col-md-12">
                                                                                        <div class="row">
                                                                                            <div class="col-md-6">
                                                                                                <label>曝光时间</label>
                                                                                                <input type="number" id="sequence_target_start"
                                                                                                    class="form-control form-control-sm" placeholder="">
                                                                                            </div>
                                                                                            <div class="col-md-6">
                                                                                                <label>曝光时间</label>
                                                                                                <input type="number" id="sequence_target_start"
                                                                                                    class="form-control form-control-sm" placeholder="">
                                                                                            </div>
                                                                                        </div>
                                                                                        
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer text-primary text-center mt-2">
                                    导星
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </section>
    </div>

    <!-- jQuery -->
    <script src="/static/js/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="/static/js/bootstrap.bundle.min.js"></script>
    <!-- Select2 -->
    <script src="/static/js/select2.full.min.js"></script>
    <!-- Chart Js -->
    <script src="/static/js/chart.min.js"></script>
    <!-- BS Stepper -->
    <script src="/static/js/bs-stepper.min.js"></script>
    <!-- Bootstrap Slider -->
    <script src="/static/js/bootstrap-slider.min.js"></script>
    <!-- AdminLTE App -->
    <script src="/static/js/adminlte.min.js"></script>
    <!-- Guider -->
    <script src="/static/js/client/guider.js"></script>

</body>